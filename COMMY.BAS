DECLARE SUB GraphUpSUB ()
DECLARE FUNCTION IsNUM! (Z$)
DECLARE SUB TimerSUB ()
DECLARE SUB GraphSUB ()
CLS
DIM CNT AS INTEGER, INNYS AS STRING, HSS AS STRING, INY AS STRING
DIM SHARED XX AS INTEGER
DIM SHARED COLO AS INTEGER
DIM SHARED VOLT AS SINGLE
DIM SHARED SCALE AS SINGLE
DIM SHARED CLICKS AS SINGLE
INPUT "Enter the scale amount: ", SCALE
INPUT "Enter the update speed in seconds: ", CLICKS
COLO = 1
HSS = "v1"
OPEN "COM1:9600,N,8,1,CD0,CS0,DS0,OP0,OP,RS,LF,ASC" FOR RANDOM AS #1
COM(1) ON
ON TIMER(CLICKS) GOSUB ASKY
TIMER ON
GraphSUB
ON COM(1) GOSUB COMMY

DO
LOOP UNTIL NOT INKEY$ = ""
COM(1) OFF
CLOSE #1
END

COMMY:
CNT = 0
DO
CNT = CNT + 1
INY = ""
IF LOC(1) > 0 THEN
INY = INPUT$(1, 1)
END IF
IF NOT INY = CHR$(10) AND NOT INY = CHR$(13) THEN
INNYS = INNYS + INY
END IF
LOOP UNTIL INY = CHR$(10) OR CNT > 100
IF IsNUM(INNYS) THEN
VOLT = VAL(INNYS)
GraphUpSUB
END IF
INNYS = ""
RETURN

ASKY:
COM(1) STOP
PRINT #1, HSS
COM(1) ON
RETURN

SUB GraphSUB

SCREEN 12
LINE (20, 40)-(620, 420), , B

LINE (20, 400)-(620, 400), 8
LINE (20, 380)-(620, 380), 8
LINE (20, 360)-(620, 360), 8
LINE (20, 340)-(620, 340), 8
LINE (20, 320)-(620, 320), 8
LINE (20, 300)-(620, 300), 8
LINE (20, 280)-(620, 280), 8
LINE (20, 260)-(620, 260), 8
LINE (20, 240)-(620, 240), 8
LINE (20, 220)-(620, 220), 8
LINE (20, 200)-(620, 200), 8
LINE (20, 180)-(620, 180), 8
LINE (20, 160)-(620, 160), 8
LINE (20, 140)-(620, 140), 8
LINE (20, 120)-(620, 120), 8
LINE (20, 100)-(620, 100), 8
LINE (20, 80)-(620, 80), 8
LINE (20, 60)-(620, 60), 8
LINE (40, 40)-(40, 420), 8
LINE (60, 40)-(60, 420), 8
LINE (60, 40)-(60, 420), 8
LINE (80, 40)-(80, 420), 8
LINE (100, 40)-(100, 420), 8
LINE (120, 40)-(120, 420), 8
LINE (140, 40)-(140, 420), 8
LINE (160, 40)-(160, 420), 8
LINE (180, 40)-(180, 420), 8
LINE (200, 40)-(200, 420), 8
LINE (220, 40)-(220, 420), 8
LINE (240, 40)-(240, 420), 8
LINE (260, 40)-(260, 420), 8
LINE (280, 40)-(280, 420), 8
LINE (300, 40)-(300, 420), 8
LINE (320, 40)-(320, 420), 8
LINE (340, 40)-(340, 420), 8
LINE (360, 40)-(360, 420), 8
LINE (380, 40)-(380, 420), 8
LINE (400, 40)-(400, 420), 8
LINE (420, 40)-(420, 420), 8
LINE (440, 40)-(440, 420), 8
LINE (460, 40)-(460, 420), 8
LINE (480, 40)-(480, 420), 8
LINE (500, 40)-(500, 420), 8
LINE (520, 40)-(520, 420), 8
LINE (540, 40)-(540, 420), 8
LINE (560, 40)-(560, 420), 8
LINE (580, 40)-(580, 420), 8
LINE (600, 40)-(600, 420), 8
LINE (0, 420)-(20, 420), 0

XX = 20
END SUB

SUB GraphUpSUB
LOCATE 1, 1
PRINT "Voltage "
PRINT VOLT
XX = XX + 1
YY = 420 - VOLT * SCALE
IF XX = 620 THEN
XX = 20
LINE (20, YY)-(20, YY)
COLO = COLO + 1
END IF
LINE -(XX, YY), COLO

END SUB

FUNCTION IsNUM (Z$)
IsNUM = 0
IF Z$ = "" THEN EXIT FUNCTION
FOR X = 1 TO LEN(Z$)
a = ASC(MID$(Z$, X, 1))
IF a < 46 OR a > 57 THEN
EXIT FUNCTION
END IF
NEXT X
IsNUM = 1
END FUNCTION

